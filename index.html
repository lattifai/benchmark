<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini Transcription Benchmark - Accuracy & Timestamps Evaluation</title>
    <meta name="description" content="Systematic evaluation of Gemini's transcription capabilities: Temperature, URL vs Local, Thinking Mode, and multi-source comparison.">

    <meta property="og:title" content="Gemini Transcription Benchmark">
    <meta property="og:description" content="Amazing accuracy, timestamps gone wrong - and how to fix them">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --bg-dark: #0a0a0f;
            --bg-card: #12121a;
            --bg-card-hover: #1a1a2e;
            --green-glow: #10b981;
            --green-light: #34d399;
            --green-bar: #059669;
            --green-bg: rgba(16, 185, 129, 0.08);
            --blue-glow: #3b82f6;
            --blue-light: #60a5fa;
            --purple-glow: #8b5cf6;
            --purple-light: #a78bfa;
            --orange-glow: #f59e0b;
            --orange-light: #fbbf24;
            --red-glow: #ef4444;
            --gray-dim: #4a4a5a;
            --gray-text: #6b7280;
            --text-white: #f9fafb;
            --text-dim: #9ca3af;
            --text-muted: #6b7280;
            --transition-fast: 0.15s ease;
            --transition-normal: 0.3s ease;
        }

        html { scroll-behavior: smooth; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-dark);
            color: var(--text-white);
            line-height: 1.7;
        }

        .error-banner {
            background: #991b1b;
            color: white;
            padding: 20px;
            text-align: center;
            font-weight: 600;
        }

        /* Hero */
        .hero {
            padding: 100px 24px 80px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: radial-gradient(ellipse at 50% 0%, rgba(16, 185, 129, 0.08) 0%, transparent 60%);
        }

        .hero-content {
            position: relative;
            max-width: 900px;
            margin: 0 auto;
        }

        .hero-badge {
            display: inline-block;
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
            padding: 6px 14px;
            border-radius: 100px;
            font-size: 13px;
            font-weight: 500;
            color: var(--green-light);
            margin-bottom: 20px;
        }

        .hero h1 {
            font-size: clamp(28px, 5vw, 48px);
            font-weight: 800;
            line-height: 1.2;
            margin-bottom: 16px;
        }

        .hero-subtitle {
            font-size: 18px;
            color: var(--text-dim);
            margin-bottom: 40px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-highlight {
            display: inline-flex;
            align-items: center;
            gap: 24px;
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px 32px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .highlight-item {
            text-align: center;
        }

        .highlight-value {
            font-size: 28px;
            font-weight: 800;
        }

        .highlight-value.good { color: var(--green-glow); }
        .highlight-value.bad { color: var(--red-glow); }

        .highlight-label {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .highlight-arrow {
            font-size: 24px;
            color: var(--green-glow);
        }

        .test-data-note {
            margin-top: 32px;
            font-size: 13px;
            color: var(--text-dim);
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
        }

        .test-data-note strong {
            color: var(--text-white);
        }

        /* Navigation */
        .nav {
            position: sticky;
            top: 0;
            z-index: 100;
            background: rgba(10, 10, 15, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
            padding: 12px 24px;
        }

        .nav-inner {
            max-width: 1100px;
            margin: 0 auto;
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .nav-link {
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-dim);
            text-decoration: none;
            transition: all var(--transition-fast);
            border: 1px solid transparent;
        }

        .nav-link:hover {
            background: var(--bg-card);
            color: var(--text-white);
        }

        .nav-link.l1 { border-color: rgba(245, 158, 11, 0.3); }
        .nav-link.l2 { border-color: rgba(59, 130, 246, 0.3); }
        .nav-link.l3 { border-color: rgba(139, 92, 246, 0.3); }
        .nav-link.l4 { border-color: rgba(16, 185, 129, 0.3); }

        /* Content */
        .content {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 24px 80px;
        }

        /* Metrics Section */
        .metrics-intro {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 60px;
            border: 1px solid rgba(255, 255, 255, 0.06);
        }

        .metrics-intro h2 {
            font-size: 20px;
            margin-bottom: 20px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 16px;
        }

        .metric-card {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
            padding: 16px;
        }

        .metric-card-name {
            font-weight: 700;
            font-size: 15px;
            margin-bottom: 4px;
        }

        .metric-card-full {
            font-size: 11px;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .metric-card-desc {
            font-size: 13px;
            color: var(--text-dim);
            line-height: 1.5;
        }

        /* Experiment */
        .experiment {
            margin-bottom: 60px;
        }

        .experiment-header {
            margin-bottom: 24px;
        }

        .experiment-level {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .experiment-level.l1 { background: rgba(245, 158, 11, 0.15); color: var(--orange-light); }
        .experiment-level.l2 { background: rgba(59, 130, 246, 0.15); color: var(--blue-light); }
        .experiment-level.l3 { background: rgba(139, 92, 246, 0.15); color: var(--purple-light); }
        .experiment-level.l4 { background: rgba(16, 185, 129, 0.15); color: var(--green-light); }

        .experiment-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .experiment-meta {
            font-size: 14px;
            color: var(--text-muted);
        }

        .experiment-body {
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.06);
            overflow: hidden;
        }

        .experiment-section {
            padding: 24px 28px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
        }

        .experiment-section:last-child {
            border-bottom: none;
        }

        .section-label {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
        }

        .section-label.question { color: var(--blue-light); }
        .section-label.setup { color: var(--purple-light); }
        .section-label.findings { color: var(--green-light); }
        .section-label.results { color: var(--orange-light); }
        .section-label.takeaway { color: var(--green-light); }

        .section-content {
            color: var(--text-dim);
            font-size: 15px;
            line-height: 1.7;
        }

        .section-content ul {
            margin: 0;
            padding-left: 20px;
        }

        .section-content li {
            margin-bottom: 8px;
        }

        .section-content strong {
            color: var(--text-white);
        }

        .section-content code {
            background: rgba(255, 255, 255, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 13px;
        }

        /* Data Table */
        .table-wrapper {
            overflow-x: auto;
            margin: 0 -8px;
            padding: 0 8px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
            min-width: 550px;
        }

        .data-table th {
            background: rgba(255, 255, 255, 0.03);
            padding: 12px 10px;
            text-align: left;
            font-weight: 600;
            color: var(--text-muted);
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
            white-space: nowrap;
        }

        .data-table th.metric {
            text-align: right;
            min-width: 80px;
        }

        .data-table td {
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.04);
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        .data-table tr:hover {
            background: rgba(255, 255, 255, 0.02);
        }

        .data-table tr.has-lattifai {
            background: linear-gradient(90deg, rgba(16, 185, 129, 0.06), transparent);
        }

        .model-cell {
            display: flex;
            align-items: center;
            gap: 6px;
            flex-wrap: wrap;
        }

        .model-name {
            font-weight: 500;
            color: var(--text-white);
        }

        .lattifai-badge {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(16, 185, 129, 0.1));
            color: var(--green-light);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
        }

        .metric-cell {
            text-align: right;
            font-variant-numeric: tabular-nums;
        }

        .metric-value {
            font-weight: 600;
        }

        .metric-value.good { color: var(--green-glow); }
        .metric-value.bad { color: var(--red-glow); }
        .metric-value.neutral { color: var(--text-white); }

        .metric-pct {
            color: var(--text-muted);
            font-size: 11px;
        }

        /* Takeaway box */
        .takeaway-box {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(16, 185, 129, 0.05));
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 10px;
            padding: 20px 24px;
        }

        .takeaway-box p {
            color: var(--text-white);
            font-size: 15px;
            font-weight: 500;
            margin: 0;
        }

        /* Note box */
        .note-box {
            background: rgba(59, 130, 246, 0.08);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 10px;
            padding: 16px 20px;
            margin-top: 16px;
            font-size: 13px;
            color: var(--text-dim);
        }

        .note-box strong {
            color: var(--blue-light);
        }

        /* Warning box */
        .warning-box {
            background: rgba(245, 158, 11, 0.08);
            border: 1px solid rgba(245, 158, 11, 0.3);
            border-radius: 12px;
            padding: 20px 24px;
            margin-top: 40px;
        }

        .warning-box h4 {
            color: var(--orange-light);
            font-size: 15px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .warning-box p {
            font-size: 14px;
            color: var(--text-dim);
            line-height: 1.6;
            margin: 0;
        }

        .warning-box strong {
            color: var(--text-white);
        }

        /* Best Practice */
        .best-practice {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(16, 185, 129, 0.05));
            border: 2px solid rgba(16, 185, 129, 0.3);
            border-radius: 16px;
            padding: 32px;
            text-align: center;
            margin-top: 60px;
        }

        .best-practice h3 {
            font-size: 20px;
            margin-bottom: 16px;
            color: var(--green-light);
        }

        .best-practice-formula {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-white);
            margin-bottom: 16px;
        }

        .best-practice-result {
            display: inline-flex;
            gap: 24px;
            background: var(--bg-dark);
            padding: 16px 32px;
            border-radius: 10px;
        }

        .best-practice-result span {
            font-size: 18px;
            font-weight: 700;
            color: var(--green-glow);
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 60px 24px;
            border-top: 1px solid rgba(255, 255, 255, 0.06);
        }

        .footer p {
            color: var(--text-muted);
            font-size: 14px;
            margin-bottom: 20px;
        }

        .footer a {
            color: var(--green-light);
            text-decoration: none;
        }

        .cta-buttons {
            display: flex;
            justify-content: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            text-decoration: none;
            transition: all var(--transition-normal);
        }

        .btn-primary {
            background: linear-gradient(to right, #7182FF, #06B6D4, #10B981);
            color: white;
        }

        .btn-primary:hover {
            opacity: 0.9;
        }

        .btn-secondary {
            background: transparent;
            color: var(--text-white);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 100px 24px;
            color: var(--text-dim);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(16, 185, 129, 0.2);
            border-top-color: var(--green-glow);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        /* Language Switcher */
        .lang-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 200;
            display: flex;
            gap: 4px;
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 4px;
        }

        .lang-btn {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            text-decoration: none;
            color: var(--text-dim);
            transition: all var(--transition-fast);
        }

        .lang-btn:hover {
            color: var(--text-white);
        }

        .lang-btn.active {
            background: var(--green-glow);
            color: white;
        }

        @media (max-width: 768px) {
            .experiment-section { padding: 20px; }
            .hero-highlight { padding: 16px 20px; gap: 16px; }
            .highlight-value { font-size: 22px; }
            .lang-switcher { top: 10px; right: 10px; }
        }
    </style>
</head>
<body>
    <!-- Language Switcher -->
    <div class="lang-switcher">
        <a href="index.html" class="lang-btn active">EN</a>
        <a href="index-zh.html" class="lang-btn">中文</a>
    </div>

    <div id="error-container"></div>

    <!-- Hero -->
    <section class="hero">
        <div class="hero-content">
            <div class="hero-badge">Open Source Benchmark</div>
            <h1>Gemini Transcription: Amazing Accuracy,<br>Timestamps Gone Wrong</h1>
            <p class="hero-subtitle">
                We systematically tested Gemini's transcription across 4 dimensions. The text is excellent—but the timestamps need help.
            </p>
            <div class="hero-highlight">
                <div class="highlight-item">
                    <div class="highlight-value bad">30-300%</div>
                    <div class="highlight-label">Original DER</div>
                </div>
                <div class="highlight-arrow">→</div>
                <div class="highlight-item">
                    <div class="highlight-value good">9-16%</div>
                    <div class="highlight-label">+LattifAI DER</div>
                </div>
            </div>
            <div class="test-data-note">
                <strong>Test Material:</strong> OpenAI GPT-4o Launch (~26 min) — 4 speakers including ChatGPT, frequent interruptions, overlapping speech, audience applause. Each experiment runs 2+ times for stability verification.
            </div>
        </div>
    </section>

    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-inner">
            <a href="#metrics" class="nav-link">Metrics</a>
            <a href="#layer1" class="nav-link l1">L1: Temperature</a>
            <a href="#layer2" class="nav-link l2">L2: URL vs Local</a>
            <a href="#layer3" class="nav-link l3">L3: Thinking Mode</a>
            <a href="#layer4" class="nav-link l4">L4: Multi-Source</a>
        </div>
    </nav>

    <!-- Content -->
    <div class="content" id="content">
        <div class="loading">
            <div class="loading-spinner"></div>
            <div>Loading benchmark data...</div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>All benchmarks are reproducible. <a href="https://github.com/lattifai/benchmark" target="_blank">View source →</a></p>
        <div class="cta-buttons">
            <a href="https://lattifai.com" class="btn btn-primary" target="_blank">Try LattifAI</a>
            <a href="https://github.com/lattifai/benchmark" class="btn btn-secondary" target="_blank">GitHub</a>
        </div>
    </footer>

    <script>
        'use strict';

        function parsePercent(val) {
            const match = val.match(/\(\s*(\d+\.?\d*)%\)/);
            if (!match) throw new Error(`Parse error: ${val}`);
            return parseFloat(match[1]);
        }

        function parseTable(lines) {
            if (lines.length < 3) throw new Error('Invalid table');
            const results = [];
            for (const row of lines.slice(2)) {
                const cols = row.split('|').map(c => c.trim()).filter(c => c);
                if (cols.length < 4) continue;
                results.push({
                    model: cols[0],
                    der: parsePercent(cols[1]),
                    jer: parsePercent(cols[2]),
                    wer: parsePercent(cols[3]),
                    sca: cols.length > 4 ? parsePercent(cols[4]) : null,
                    hasLattifai: cols[0].includes('+LattifAI')
                });
            }
            return results;
        }

        function extractTables(text) {
            const sections = { main: null, urlLocal: null, thinking: null, temperature: null };
            const pattern = /##### ([^\n]+)\n([\s\S]*?)(?=\n##### |\n## |\n> \*\*Metrics|$)/g;
            let match;

            while ((match = pattern.exec(text)) !== null) {
                const title = match[1].trim();
                const content = match[2];
                const codeBlock = content.match(/```\n?([\s\S]*?)```/);
                if (!codeBlock) continue;

                const lines = codeBlock[1].split('\n').filter(l => l.startsWith('|'));
                if (lines.length === 0) continue;

                const data = parseTable(lines);
                let note = null;
                const noteMatch = content.match(/> \*\*Note[^*]*\*\*:([^>]*)/s);
                if (noteMatch) note = noteMatch[1].trim().replace(/\s+/g, ' ');

                if (title.includes('Main Benchmark')) sections.main = { data, note };
                else if (title.includes('URL vs Local')) sections.urlLocal = { data };
                else if (title.includes('Thinking Mode')) sections.thinking = { data };
                else if (title.includes('Temperature')) sections.temperature = { data };
            }

            for (const [k, v] of Object.entries(sections)) {
                if (!v) throw new Error(`Missing: ${k}`);
            }
            return sections;
        }

        function renderTable(data, opts = {}) {
            const hasSCAData = data.some(r => r.sca !== null);
            const showSCA = opts.showSCA !== false && hasSCAData;
            return `
                <div class="table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Model</th>
                                <th class="metric">DER ↓</th>
                                <th class="metric">JER ↓</th>
                                <th class="metric">WER ↓</th>
                                ${showSCA ? '<th class="metric">SCA ↑</th>' : ''}
                            </tr>
                        </thead>
                        <tbody>
                            ${data.map(r => `
                                <tr class="${r.hasLattifai ? 'has-lattifai' : ''}">
                                    <td>
                                        <div class="model-cell">
                                            <span class="model-name">${r.model.replace(' +LattifAI', '')}</span>
                                            ${r.hasLattifai ? '<span class="lattifai-badge">+LattifAI</span>' : ''}
                                        </div>
                                    </td>
                                    <td class="metric-cell">
                                        <span class="metric-value ${r.der < 15 ? 'good' : r.der > 50 ? 'bad' : 'neutral'}">${r.der.toFixed(2)}</span>
                                        <span class="metric-pct">%</span>
                                    </td>
                                    <td class="metric-cell">
                                        <span class="metric-value ${r.jer < 20 ? 'good' : r.jer > 50 ? 'bad' : 'neutral'}">${r.jer.toFixed(2)}</span>
                                        <span class="metric-pct">%</span>
                                    </td>
                                    <td class="metric-cell">
                                        <span class="metric-value ${r.wer < 5 ? 'good' : r.wer > 10 ? 'bad' : 'neutral'}">${r.wer.toFixed(2)}</span>
                                        <span class="metric-pct">%</span>
                                    </td>
                                    ${showSCA ? `
                                        <td class="metric-cell">
                                            <span class="metric-value ${r.sca === 100 ? 'good' : 'bad'}">${r.sca.toFixed(0)}</span>
                                            <span class="metric-pct">%</span>
                                        </td>
                                    ` : ''}
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }

        function render(sections) {
            document.getElementById('content').innerHTML = `
                <!-- Metrics -->
                <section id="metrics" class="metrics-intro">
                    <h2>Understanding the Metrics</h2>
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-card-name">DER</div>
                            <div class="metric-card-full">Diarization Error Rate</div>
                            <div class="metric-card-desc">Measures timestamp accuracy + speaker labeling. DER > 100% means severe timing issues.</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-card-name">JER</div>
                            <div class="metric-card-full">Jaccard Error Rate</div>
                            <div class="metric-card-desc">Stricter overlap calculation for segment boundaries.</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-card-name">WER</div>
                            <div class="metric-card-full">Word Error Rate</div>
                            <div class="metric-card-desc">Text accuracy. Lower = fewer transcription errors.</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-card-name">SCA</div>
                            <div class="metric-card-full">Speaker Count Accuracy</div>
                            <div class="metric-card-desc">Did the model detect the correct number of speakers?</div>
                        </div>
                    </div>
                </section>

                <!-- Layer 1: Temperature -->
                <section id="layer1" class="experiment">
                    <div class="experiment-header">
                        <span class="experiment-level l1">Layer 1</span>
                        <h2 class="experiment-title">Temperature Parameter</h2>
                        <p class="experiment-meta">Test material: 5-min single-speaker audio • 2 runs per setting</p>
                    </div>
                    <div class="experiment-body">
                        <div class="experiment-section">
                            <div class="section-label question">The Question</div>
                            <div class="section-content">
                                <p>Temperature controls output randomness. <strong>Gemini's default doesn't let users set it (None)</strong>. Does manually setting temperature affect accuracy or timestamp stability?</p>
                            </div>
                        </div>
                        <div class="experiment-section">
                            <div class="section-label setup">Test Setup</div>
                            <div class="section-content">
                                <ul>
                                    <li>Temperature values: <code>1.0</code>, <code>0.5</code>, <code>0.1</code></li>
                                    <li>Two runs per setting to measure consistency</li>
                                </ul>
                            </div>
                        </div>
                        <div class="experiment-section">
                            <div class="section-label findings">Key Findings</div>
                            <div class="section-content">
                                <ul>
                                    <li><strong>WER is stable</strong>: All settings produce 1.3-1.9% WER—temperature barely affects text accuracy</li>
                                    <li><strong>temp=0.5 is unstable</strong>: DER jumped from 19% to 30% between runs</li>
                                    <li><strong>temp=0.1 is most consistent</strong>: Only 1.4% DER variance between runs</li>
                                    <li><strong>Lower ≠ Better</strong>: temp=0.1 isn't more accurate, just more reproducible</li>
                                </ul>
                            </div>
                        </div>
                        <div class="experiment-section">
                            <div class="section-label results">Results</div>
                            ${renderTable(sections.temperature.data, { showSCA: false })}
                        </div>
                        <div class="experiment-section">
                            <div class="section-label takeaway">Takeaway</div>
                            <div class="takeaway-box">
                                <p>Use <strong>temp=0.1</strong> if you need reproducible results. For best single-run quality, any setting works.</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Layer 2: URL vs Local -->
                <section id="layer2" class="experiment">
                    <div class="experiment-header">
                        <span class="experiment-level l2">Layer 2</span>
                        <h2 class="experiment-title">URL vs Local Audio</h2>
                        <p class="experiment-meta">Test material: OpenAI GPT-4o launch (~26 min, multi-speaker)</p>
                    </div>
                    <div class="experiment-body">
                        <div class="experiment-section">
                            <div class="section-label question">The Question</div>
                            <div class="section-content">
                                <p>Gemini accepts YouTube URLs or local files. Does the input method affect quality? Does video metadata (title, description) help?</p>
                            </div>
                        </div>
                        <div class="experiment-section">
                            <div class="section-label setup">Test Setup</div>
                            <div class="section-content">
                                <ul>
                                    <li>Same audio via URL vs local MP3</li>
                                    <li>Tested on Gemini 3 Flash and Gemini 3 Pro</li>
                                    <li>Local input had <strong>no description</strong>; URL had video metadata</li>
                                    <li><strong>Difficulty increase</strong>: From single-speaker (L1) to 4-speaker with interruptions → WER ~1.5% → ~4.5% (3x increase)</li>
                                </ul>
                            </div>
                        </div>
                        <div class="experiment-section">
                            <div class="section-label findings">Key Findings</div>
                            <div class="section-content">
                                <ul>
                                    <li><strong>Flash: Nearly identical</strong> — DER differs by ~1% (31.86% vs 33.12%)</li>
                                    <li><strong>Pro: URL mode unstable</strong> — DER 311% vs Local's 40%. Generative models sometimes hallucinate timestamps far beyond the actual duration (e.g., 1-hour marks in a 26-min video)</li>
                                    <li><strong>Metadata doesn't help</strong> — URL (with metadata) ≈ Local (no metadata)</li>
                                    <li><strong>Speaker names: 100% accurate</strong> — Even with local files (no metadata), the model correctly identified all speakers (Mira Murati, Mark Chen, Barret Zoph, ChatGPT)</li>
                                    <li><strong>LattifAI fixes both</strong> — All corrected to 11-20% DER range</li>
                                </ul>
                            </div>
                        </div>
                        <div class="experiment-section">
                            <div class="section-label results">Results</div>
                            ${renderTable(sections.urlLocal.data)}
                        </div>
                        <div class="experiment-section">
                            <div class="section-label takeaway">Takeaway</div>
                            <div class="takeaway-box">
                                <p><strong>Flash:</strong> Use either method. <strong>Pro:</strong> Always use local files—URL mode has serious issues.</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Layer 3: Thinking Mode -->
                <section id="layer3" class="experiment">
                    <div class="experiment-header">
                        <span class="experiment-level l3">Layer 3</span>
                        <h2 class="experiment-title">Thinking Mode Impact</h2>
                        <p class="experiment-meta">Test material: OpenAI GPT-4o launch</p>
                    </div>
                    <div class="experiment-body">
                        <div class="experiment-section">
                            <div class="section-label question">The Question</div>
                            <div class="section-content">
                                <p>Gemini 3 introduced Thinking Mode. Does the extra "reasoning" time improve timestamp accuracy?</p>
                            </div>
                        </div>
                        <div class="experiment-section">
                            <div class="section-label findings">Key Findings</div>
                            <div class="section-content">
                                <ul>
                                    <li><strong>WER improves ~1%</strong>: no-think 5-6.5% → think 4.3-4.8%</li>
                                    <li><strong>DER unchanged</strong>: Both modes hover around 30-33% for Flash</li>
                                    <li><strong>Pro is unstable</strong>: think-URL fails (311%), no-think-Local fails (306%)</li>
                                    <li><strong>Critical insight</strong>: We examined the thinking output—it's just a <em>draft transcript</em>, not timestamp reasoning</li>
                                </ul>
                            </div>
                        </div>
                        <div class="experiment-section">
                            <div class="section-label results">Results</div>
                            ${renderTable(sections.thinking.data)}
                            <div class="note-box">
                                <strong>Why doesn't Thinking Mode help timestamps?</strong> From what we observed, the "thinking" output appears to be draft transcripts rather than timestamp reasoning. However, this needs further investigation—Google may not expose the full thinking process, or additional prompt optimization could unlock better results.
                            </div>
                        </div>
                        <div class="experiment-section">
                            <div class="section-label takeaway">Takeaway</div>
                            <div class="takeaway-box">
                                <p><strong>Enable Thinking Mode</strong> for ~1% better WER. But for timestamps, you still need forced alignment.</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Layer 4: Multi-Source -->
                <section id="layer4" class="experiment">
                    <div class="experiment-header">
                        <span class="experiment-level l4">Layer 4</span>
                        <h2 class="experiment-title">Multi-Source & Prompt Engineering</h2>
                        <p class="experiment-meta">Test material: OpenAI GPT-4o launch • Multiple prompt variants</p>
                    </div>
                    <div class="experiment-body">
                        <div class="experiment-section">
                            <div class="section-label question">The Question</div>
                            <div class="section-content">
                                <p>How does Gemini compare to YouTube auto-captions? Can prompt engineering improve timestamps?</p>
                            </div>
                        </div>
                        <div class="experiment-section">
                            <div class="section-label setup">Prompt Variants Tested</div>
                            <div class="section-content">
                                <ul>
                                    <li><strong>dotey</strong>: Base prompt from @dotey</li>
                                    <li><strong>Precise</strong>: Request millisecond precision</li>
                                    <li><strong>StartEnd</strong>: Include both start and end times</li>
                                    <li><strong>SRT V2</strong>: Output directly as SRT format</li>
                                </ul>
                            </div>
                        </div>
                        <div class="experiment-section">
                            <div class="section-label findings">Key Findings</div>
                            <div class="section-content">
                                <ul>
                                    <li><strong>Gemini WER 5x better than YouTube</strong>: 4-5% vs 21%</li>
                                    <li><strong>Prompt format affects DER 3.6x</strong>: Precise 21% vs SRT 77%</li>
                                    <li><strong>SRT format backfires</strong>: SRT's line-width limits force speaker labels into cramped segments, causing speaker crossover and amplified timing errors → worse DER</li>
                                    <li><strong>YouTube captions: DER 172%</strong>: Timestamps are completely off (but fixable)</li>
                                    <li><strong>LattifAI normalizes all sources</strong>: 172% → 15%, 77% → 10%, 21% → 9%</li>
                                </ul>
                            </div>
                        </div>
                        <div class="experiment-section">
                            <div class="section-label results">Results</div>
                            ${renderTable(sections.main.data)}
                            ${sections.main.note ? `
                                <div class="note-box">
                                    <strong>Note on WER:</strong> ${sections.main.note}
                                </div>
                            ` : ''}
                        </div>
                        <div class="experiment-section">
                            <div class="section-label takeaway">Takeaway</div>
                            <div class="takeaway-box">
                                <p>Prompt engineering has <strong>limited effect</strong> on timestamps—this is an architectural issue. Use the "Precise" prompt for best raw results, then apply forced alignment.</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Hallucination Warning -->
                <div class="warning-box">
                    <h4>⚠️ Hallucination Warning</h4>
                    <p>Beyond timestamp issues, we observed <strong>text hallucinations</strong> in Gemini outputs. During rapid speaker exchanges (e.g., human-ChatGPT dialogue with frequent interruptions), the transcript sometimes contains <strong>content that doesn't exist in the original audio</strong>. This is likely caused by the model "completing" what it thinks should be said. For verbatim-critical use cases (legal, medical), manual review is recommended.</p>
                </div>

                <!-- Best Practice -->
                <div class="best-practice">
                    <h3>Best Practice</h3>
                    <div class="best-practice-formula">
                        Gemini 3 Flash + Precise Prompt + Thinking Mode + LattifAI
                    </div>
                    <div class="best-practice-result">
                        <span>WER 4.19%</span>
                        <span>DER 9.29%</span>
                    </div>
                </div>
            `;
        }

        function showError(msg) {
            document.getElementById('error-container').innerHTML = `<div class="error-banner">Error: ${msg}</div>`;
            document.getElementById('content').innerHTML = `<div style="text-align:center;padding:100px 24px;color:#ef4444;"><h2>Failed to Load</h2><p style="margin-top:16px;color:var(--text-dim);">${msg}</p></div>`;
        }

        async function load() {
            const res = await fetch('README.md');
            if (!res.ok) throw new Error(`Fetch failed: ${res.status}`);
            const text = await res.text();
            if (!text.includes('#### Results')) throw new Error('Missing "#### Results"');
            render(extractTables(text));
        }

        window.addEventListener('load', () => load().catch(e => showError(e.message)));
    </script>
</body>
</html>
